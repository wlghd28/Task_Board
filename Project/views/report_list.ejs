<section id="search-result-container" class="container">
    <div class="d-flex justify-content-center mx-auto main-label" style="margin:auto">
        <div class="row">
            <div>
               <br><h4>주간보고서</h4>
            </div>
        </div>
    </div>
    <div align-content="right" id="detail_searchoption" class="detail_searchoption">
        <div style="display:block;float:right">
            <form action="/report/simplesearch" method="get" id="simple_search" style="display:inline">
                <input type="text" id="simple_search_text" name="simple_search_text" placeholder="검색할 단어를 입력하세요.">
                <input type="submit" value="검색">
            </form>
            <button id="toc-toggle" onclick="openCloseToc()" style="margin-left:5px">상세 &#9660;</button>
        </div>
        <div id="toc-content">        
            <form action="/report/detailsearch" method="get" id="detail_search">
                포함된 단어<br>
                <input type="text" id="detail_search_text" name="detail_search_text" placeholder="검색할 단어를 입력하세요." style="width:100%">
                <hr>
                날짜
                <br>
                <input type="date" id="detail_search_startdate" name="detail_search_startdate" style="width:40%"> 
                ~ 
                <input type="date" id="detail_search_enddate" name="detail_search_enddate" style="width:40%">
                <hr>
                보고자
                <br>
                <input type="text" id="detail_search_user" name="detail_search_user" placeholder="검색할 이름을 입력하세요." style="width:30%">
                <hr>
                <input type="submit" value="검색" style="float:right">
            </form>
        </div>
    </div>
    <br>
    <strong style="float:left;">* 최신 5000개의 보고서만 보여집니다.</strong>
    <br>
    <div class="table table-bordered table-responsive">
        <table id="inquire-table" style="text-align: center;" width="100%" height="100%">
            <tbody class="table">
                <tr class="table-warning">
                    <th width="10%" >No.</th>
                    <th width="70%" >Date</th>
                    <th width="20%" >보고자</th>
                </tr>
                <% if(List) { %>
                    <% List.forEach(function (report, index) { %>    
                        <tr>
                            <td><%=index + 1 %></td>
                            <td>
                                <form action='/report/list/content' method=get id='<%=index %>'>
                                    <a href=# onclick="document.getElementById('<%=index %>').submit();" >
                                        <%=report["DATE_FORMAT(report_date,'%Y-%m-%d')"]  %>
                                    </a>
                                    <input type='hidden' name='userid', value=<%=report.report_userid %>>
                                    <input type='hidden' name='username', value=<%=report.report_username %>>
                                    <input type='hidden' name='date', value=<%=report["DATE_FORMAT(report_date,'%Y-%m-%d')"] %>>
                                </form>
                            </td>
                            <td><%=report.report_username %></td>
                        </tr>              
                    <% }); %>
                <% } %>
            </tbody>
        </table>
    </div>
</section>

<script>
    // 페이지 로드할 때 실행
    window.onload = function(){
        GetPosition_toc_content ();
    }

    // 화면 크기 변경 감지
    window.addEventListener('resize', function(){
        GetPosition_toc_content ();
    });

    // 화면 회전감지
    window.addEventListener('orientationchange', function(){
        GetPosition_toc_content ();
    });


    function openCloseToc() {
        if(document.getElementById('toc-content').style.display === 'block') {
            document.getElementById('toc-content').style.display = 'none';
        } else {
            document.getElementById('toc-content').style.display = 'block';
        }

        GetPosition_toc_content ();
    } 

    function GetPosition_toc_content () {
        const toc_content = document.getElementById("toc-content");
        const toc_toggle = document.getElementById("toc-toggle");
        const detail_searchoption = document.getElementById("detail_searchoption");

        const absoluteTop_toc_toggle = window.pageYOffset + toc_toggle.getBoundingClientRect().top;
        const absoluteRight_toc_toggle = window.pageXOffset + toc_toggle.getBoundingClientRect().right;

        toc_content.style.top = absoluteTop_toc_toggle + toc_toggle.offsetHeight + "px";     
        toc_content.style.right = absoluteRight_toc_toggle - detail_searchoption.offsetWidth + "px";
    }

    
</script>